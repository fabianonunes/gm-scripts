#!/usr/bin/env bash

pluristamp () {
	[[ $1 ]] && pdftk "$1" multistamp - output - | pluristamp "${@:2}" || cat
}

data_barcode=$(printf "%020d" $(basename $1 | tr -cd '[[:digit:]]'))

barcode -umm -p a4 -g 45x1.3+158.5+246 -e 128 -n -b $data_barcode | \
ps2pdf - - | \
pluristamp "${@:2}" | \
pdftk "$1" multistamp - output -
